---
title: "Garbage Can Regression Challenge"
format:
  html: default
execute:
  echo: false
  eval: true
---

# Garbage Can Regression Challenge

**Choose R or Python and delete the other code chunk.**

## R Code

```{r}
#| echo: true
library(tidyverse)
library(broom)

# Data with known true relationships: Anxiety = Stress + 0.1 Ã— Time
observDF <- tribble(
  ~Stress, ~StressSurvey, ~Time, ~Anxiety,
  0,0,0,0,
  0,0,1,0.1,
  0,0,1,0.1,
  1,3,1,1.1,
  1,3,1,1.1,
  1,3,1,1.1,
  2,6,2,2.2,
  2,6,2,2.2,
  2,6,2,2.2,
  8,9,2,8.2,
  8,9,2,8.2,
  8,9,2.1,8.21,
  12,12,2.2,12.22,
  12,12,2.2,12.22,
  12,12,2.2,12.22
)

observDF

# Follow the challenge instructions from your course to complete your analysis.
# Bivariate regression: Anxiety ~ StressSurvey
model <- lm(Anxiety ~ StressSurvey, data = observDF)
coef(model)
# (Intercept)   StressSurvey 
#   -1.524000      1.047000


# Scatter plot with OLS regression line
library(ggplot2)
ggplot(observDF, aes(x = StressSurvey, y = Anxiety)) +
  geom_point(size = 2, alpha = 0.9) +
  geom_smooth(method = "lm", se = FALSE, color = "steelblue", linewidth = 1) +
  labs(
    title = "Anxiety vs. StressSurvey with OLS fit",
    x = "StressSurvey",
    y = "Anxiety"
  )
# As the level of anxiety increases, the level of stress survey also increases.


# Bivariate regression: Anxiety ~ Time
model_time <- lm(Anxiety ~ Time, data = observDF)
coef(model_time)

# Scatter plot with OLS regression line for Time
ggplot(observDF, aes(x = Time, y = Anxiety)) +
  geom_point(size = 2, alpha = 0.9) +
  geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linewidth = 1) +
  labs(
    title = "Anxiety vs. Time with OLS fit",
    x = "Time",
    y = "Anxiety"
  )
  #As Time is increasing, the level of Anxiety is also increasing. There is an extreme outlier on Anxiety. 


# Multiple regression: Anxiety ~ StressSurvey + Time
model_multiple <- lm(Anxiety ~ StressSurvey + Time, data = observDF)
broom::tidy(model_multiple)

# Compare with true model: Anxiety ~ Stress + Time
model_true <- lm(Anxiety ~ Stress + Time, data = observDF)
broom::tidy(model_true)

  
```
## Your Analysis

